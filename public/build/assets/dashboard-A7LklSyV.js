import{j as e,r as i,a as S,u as T,H as $}from"./app-Bfw4HYth.js";import{C as O,A as z}from"./app-layout-CAmCD_I7.js";import{I as A}from"./index-Dx1WLYS9.js";import{a as m}from"./createLucideIcon-DCWCpbbp.js";import{D as q,a as B}from"./dialog-BCmfkKJJ.js";/* empty css            */import"./index-DthzJYhO.js";import"./index-BVvU_3WY.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],H=m("ChevronLeft",F);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],V=m("EllipsisVertical",R);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],W=m("Pen",K);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],J=m("Plus",G);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],U=m("Search",Q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Y=m("Share2",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ee=m("Trash2",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ne=m("WifiOff",te);function w({Icon:o,onClick:n}){return e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center bg-white/15 hover:bg-white/25 rounded-full text-white transition-all duration-300",children:e.jsx(o,{size:12})})}function se({isHovered:o,memeId:n}){const[s,x]=i.useState(!1);i.useEffect(()=>{o||x(!1)},[o]);const u=new A().v1().meme(),l=async r=>{r.stopPropagation(),await u.delete(n)},p=r=>{r.stopPropagation(),S.visit(route("meme.edit",n))};return e.jsxs("div",{className:`absolute top-0 left-0 w-full h-15% bg-black/40 backdrop-blur-sm flex justify-end items-start px-2 transition-transform duration-300 ${o?"translate-y-0":"-translate-y-full"}`,children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),x(!0)},className:`text-white p-2 hover:bg-white/20 rounded-full mt-1 transition-opacity duration-200 ${s?"opacity-0 pointer-events-none":"opacity-100"}`,children:e.jsx(V,{size:12})}),e.jsxs("div",{className:`flex items-center gap-2 pr-2 transition-all duration-300 ${s?"translate-x-0 opacity-100":"translate-x-10 opacity-0 pointer-events-none"}`,children:[e.jsx(w,{Icon:W,onClick:p}),e.jsx(w,{Icon:ee,onClick:l}),e.jsx(w,{Icon:Y,onClick:r=>r.stopPropagation()})]})]})}function re({isHovered:o,title:n}){return e.jsx("div",{className:`absolute bottom-0 left-0 w-full bg-black/60 text-white text-center text-sm py-2
          transition-transform duration-300 ${o?"translate-y-0":"translate-y-full"}`,children:n})}function ae({id:o,title:n,image_url:s,onOpen:x}){const[u,l]=i.useState(!1);return e.jsxs("div",{className:"relative w-full aspect-[3/4] overflow-hidden rounded-2xl border border-gray-300 dark:border-gray-700 bg-neutral-50 dark:bg-neutral-900 cursor-pointer sm:h-[258px] sm:aspect-auto sm:rounded-lg",onMouseEnter:()=>l(!0),onMouseLeave:()=>{l(!1)},onClick:x,children:[e.jsx("img",{src:s,alt:n,className:`w-full h-full object-cover transition-transform duration-500 ${u?"scale-105":""}`}),e.jsx(se,{isHovered:u,memeId:o}),e.jsx(re,{isHovered:u,title:n})]},o)}function oe({isOpen:o,onOpenChange:n,meme:s,onPrev:x,onNext:u,hasPrev:l,hasNext:p}){return s?e.jsx(q,{open:o,onOpenChange:n,children:e.jsxs(B,{className:"top-0 left-0 h-full w-full max-w-none translate-x-0 translate-y-0 gap-0 rounded-none border-0 bg-black/95 p-0 sm:top-[50%] sm:left-[50%] sm:h-auto sm:w-full sm:max-w-5xl sm:-translate-x-1/2 sm:-translate-y-1/2 sm:gap-4 sm:rounded-lg sm:border sm:border-neutral-800 sm:bg-black/90 sm:p-4",children:[s.type==="video"?e.jsx("video",{src:s.media_url,controls:!0,className:"h-full w-full object-contain bg-black sm:h-auto sm:max-h-[80vh] sm:rounded-lg"}):e.jsx("img",{src:s.media_url,alt:s.title,className:"h-full w-full object-contain bg-black sm:h-auto sm:max-h-[80vh] sm:rounded-lg"}),e.jsx("button",{type:"button",onClick:x,disabled:!l,className:"absolute left-3 top-1/2 -translate-y-1/2 rounded-full border border-neutral-700 bg-black/60 p-2 text-white transition disabled:opacity-40",children:e.jsx(H,{size:20})}),e.jsx("button",{type:"button",onClick:u,disabled:!p,className:"absolute right-3 top-1/2 -translate-y-1/2 rounded-full border border-neutral-700 bg-black/60 p-2 text-white transition disabled:opacity-40",children:e.jsx(O,{size:20})})]})}):null}function le({memes:o}){const[n,s]=i.useState(null),[x,u]=i.useState(!1),l=d=>{s(d),u(!0)},p=d=>{u(d),d||s(null)},r=()=>{n!==null&&s(Math.max(0,n-1))},g=()=>{n!==null&&s(Math.min(o.length-1,n+1))},j=n!==null?o[n]:null;return e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("div",{className:"grid w-full grid-cols-2 gap-3 sm:grid-cols-[repeat(auto-fill,minmax(198px,1fr))] sm:gap-4",children:o.map((d,b)=>e.jsx(ae,{id:d.id,title:d.title,image_url:d.image_url,media_url:d.media_url,type:d.type,onOpen:()=>l(b)}))}),e.jsx(oe,{isOpen:x,onOpenChange:p,meme:j,onPrev:r,onNext:g,hasPrev:n!==null&&n>0,hasNext:n!==null&&n<o.length-1})]})}const ie=[{title:"Мемчики",href:"/"}],ce=[{Icon:J,target_url:"/memes/new",isActive:!1}];function be(){const{memes:o,availableTags:n,selectedTags:s}=T().props,[x,u]=i.useState(!0),[l,p]=i.useState(""),[r,g]=i.useState(s??[]),[j,d]=i.useState(!1),[b,y]=i.useState((s??[]).length>0),[h,v]=i.useState(0),k=i.useRef(null);i.useEffect(()=>{g(s??[]),(s??[]).length>0&&y(!0)},[s?.join("|")]);const c=i.useMemo(()=>{const t=l.trim().toLowerCase(),a=n.filter(f=>!r.includes(f));return t?a.filter(f=>f.toLowerCase().includes(t)).slice(0,8):a.slice(0,8)},[r,n,l]);i.useEffect(()=>{h>=c.length&&c.length>0&&v(0)},[h,c.length]);const N=t=>{const a=t.length>0?{tags:t}:{};S.get(route("dashboard"),a,{preserveScroll:!0,preserveState:!0,replace:!0})},M=t=>{const a=t.trim();if(!a||r.includes(a)){p("");return}const f=[...r,a];g(f),p(""),N(f)},C=t=>{const a=r.filter(f=>f!==t);g(a),N(a)},I=t=>{if(t.key==="Escape"){t.preventDefault(),r.length===0&&l.trim()===""&&y(!1);return}if(t.key==="Backspace"&&l.trim()===""){r.length>0&&(t.preventDefault(),C(r[r.length-1]));return}if(t.key==="Tab"&&c.length>0){t.preventDefault();const f=t.shiftKey?-1:1,D=(h+f+c.length)%c.length;v(D);return}if(t.key!=="Enter"||(t.preventDefault(),c.length===0))return;const a=c[h]??c[0];a&&M(a)},E=()=>{y(!0),requestAnimationFrame(()=>k.current?.focus())},L=()=>{d(!1),r.length===0&&l.trim()===""&&y(!1)},_=i.useMemo(()=>{const t=l;if(!t)return"";const a=c[h]??c[0];return!a||!a.toLowerCase().startsWith(t.toLowerCase())?"":a.slice(t.length)},[h,c,l]),P=e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:["flex items-center overflow-hidden rounded-xl transition-all duration-300",b?"w-[220px] px-2 py-1 sm:w-[320px] border border-foreground/10 bg-foreground/5":"w-9 px-0 py-0 border border-transparent bg-transparent"].join(" "),children:[e.jsx("button",{type:"button",onClick:E,className:"flex h-9 w-9 items-center justify-center text-muted-foreground transition hover:text-foreground",children:e.jsx(U,{size:16})}),e.jsxs("div",{className:`flex flex-1 items-center gap-2 transition-opacity duration-200 ${b?"opacity-100":"pointer-events-none opacity-0"}`,children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:r.map(t=>e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-400/40 bg-emerald-400/10 px-2 py-0.5 text-[11px] font-medium text-emerald-700",children:[t,e.jsx("button",{type:"button",className:"text-emerald-700/70 hover:text-emerald-800",onClick:()=>C(t),children:"×"})]},t))}),e.jsxs("div",{className:"relative flex-1",children:[_&&e.jsxs("span",{className:"pointer-events-none absolute left-0 top-1/2 -translate-y-1/2 text-xs text-muted-foreground/60",children:[e.jsx("span",{className:"invisible",children:l}),_]}),e.jsx("input",{ref:k,value:l,onChange:t=>{p(t.target.value),v(0)},onKeyDown:I,onFocus:()=>d(!0),onBlur:L,placeholder:n.length?"Тег":"Нет тегов",className:"h-8 min-w-[100px] w-full bg-transparent text-xs text-foreground outline-none placeholder:text-muted-foreground",disabled:n.length===0})]})]})]}),b&&j&&c.length>0&&e.jsx("div",{className:"absolute right-0 top-full z-20 mt-2 w-[220px] sm:w-[320px]",onMouseDown:t=>t.preventDefault(),children:e.jsxs("div",{className:"rounded-2xl border border-border/70 bg-background p-2 shadow-lg",children:[e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1",children:"Возможные теги"}),e.jsx("div",{className:"flex flex-wrap gap-2 px-2 pb-2",children:c.map((t,a)=>e.jsx("button",{type:"button",onClick:()=>M(t),onMouseEnter:()=>v(a),className:["rounded-full border px-3 py-1 text-xs font-medium text-foreground transition",a===h?"border-foreground/20 bg-foreground/15":"border-foreground/10 bg-foreground/5 hover:bg-foreground/10"].join(" "),children:t},t))})]})})]});return i.useEffect(()=>{const t=()=>u(navigator.onLine);return t(),window.addEventListener("online",t),window.addEventListener("offline",t),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",t)}},[]),e.jsxs(z,{breadcrumbs:ie,actions:ce,actionsNode:P,children:[e.jsx($,{title:"Meme Cloud"}),!x&&e.jsx("div",{className:"mx-4 mb-4 rounded-2xl border border-amber-200/70 bg-amber-50 px-4 py-3 text-amber-900 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-amber-100 text-amber-700",children:e.jsx(ne,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold",children:"Нет соединения"}),e.jsx("div",{className:"text-amber-800/80",children:"Показываем сохранённые мемы и медиа."})]})]})}),e.jsx(le,{memes:o})]})}export{be as default};
