import{j as e,r as l,a as C,u as P,H as L}from"./app-B9Umk_uZ.js";import{C as D,A as $}from"./app-layout-C5L9RwJ9.js";import{I as O}from"./index-C_M0y9rm.js";import{c as h}from"./createLucideIcon-IkC2iEO4.js";import{D as A,a as q}from"./dialog-By-8HjkR.js";import z from"./offline-BHxT6KsH.js";/* empty css            */import"./app-logo-icon-D9-lCxMt.js";import"./index-C_iShRSu.js";import"./index-BnmarE5F.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],F=h("ChevronLeft",B);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],R=h("EllipsisVertical",H);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],K=h("Pen",V);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],G=h("Plus",W);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],S=h("Search",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],U=h("Share2",Q);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Y=h("Trash2",X);function y({Icon:r,onClick:n}){return e.jsx("button",{onClick:n,className:"w-8 h-8 flex items-center justify-center bg-white/15 hover:bg-white/25 rounded-full text-white transition-all duration-300",children:e.jsx(r,{size:12})})}function Z({isHovered:r,memeId:n}){const[s,u]=l.useState(!1);l.useEffect(()=>{r||u(!1)},[r]);const a=new O().v1().meme(),i=async f=>{f.stopPropagation(),await a.delete(n)},p=f=>{f.stopPropagation(),C.visit(route("meme.edit",n))};return e.jsxs("div",{className:`absolute top-0 left-0 w-full h-15% bg-black/40 backdrop-blur-sm flex justify-end items-start px-2 transition-transform duration-300 ${r?"translate-y-0":"-translate-y-full"}`,children:[e.jsx("button",{onClick:f=>{f.stopPropagation(),u(!0)},className:`text-white p-2 hover:bg-white/20 rounded-full mt-1 transition-opacity duration-200 ${s?"opacity-0 pointer-events-none":"opacity-100"}`,children:e.jsx(R,{size:12})}),e.jsxs("div",{className:`flex items-center gap-2 pr-2 transition-all duration-300 ${s?"translate-x-0 opacity-100":"translate-x-10 opacity-0 pointer-events-none"}`,children:[e.jsx(y,{Icon:K,onClick:p}),e.jsx(y,{Icon:Y,onClick:i}),e.jsx(y,{Icon:U,onClick:f=>f.stopPropagation()})]})]})}function ee({isHovered:r,title:n}){return e.jsx("div",{className:`absolute bottom-0 left-0 w-full bg-black/60 text-white text-center text-sm py-2
          transition-transform duration-300 ${r?"translate-y-0":"translate-y-full"}`,children:n})}function te({id:r,title:n,image_url:s,onOpen:u}){const[a,i]=l.useState(!1);return e.jsxs("div",{className:"relative w-full aspect-[3/4] overflow-hidden rounded-2xl border border-gray-300 dark:border-gray-700 bg-neutral-50 dark:bg-neutral-900 cursor-pointer sm:h-[258px] sm:aspect-auto sm:rounded-lg",onMouseEnter:()=>i(!0),onMouseLeave:()=>{i(!1)},onClick:u,children:[e.jsx("img",{src:s,alt:n,className:`w-full h-full object-cover transition-transform duration-500 ${a?"scale-105":""}`}),e.jsx(Z,{isHovered:a,memeId:r}),e.jsx(ee,{isHovered:a,title:n})]},r)}function ne({isOpen:r,onOpenChange:n,meme:s,onPrev:u,onNext:a,hasPrev:i,hasNext:p}){return s?e.jsx(A,{open:r,onOpenChange:n,children:e.jsxs(q,{className:"top-0 left-0 h-full w-full max-w-none translate-x-0 translate-y-0 gap-0 rounded-none border-0 bg-black/95 p-0 sm:top-[50%] sm:left-[50%] sm:h-auto sm:w-full sm:max-w-5xl sm:-translate-x-1/2 sm:-translate-y-1/2 sm:gap-4 sm:rounded-lg sm:border sm:border-neutral-800 sm:bg-black/90 sm:p-4",children:[s.type==="video"?e.jsx("video",{src:s.media_url,controls:!0,className:"h-full w-full object-contain bg-black sm:h-auto sm:max-h-[80vh] sm:rounded-lg"}):e.jsx("img",{src:s.media_url,alt:s.title,className:"h-full w-full object-contain bg-black sm:h-auto sm:max-h-[80vh] sm:rounded-lg"}),e.jsx("button",{type:"button",onClick:u,disabled:!i,className:"absolute left-3 top-1/2 -translate-y-1/2 rounded-full border border-neutral-700 bg-black/60 p-2 text-white transition disabled:opacity-40",children:e.jsx(F,{size:20})}),e.jsx("button",{type:"button",onClick:a,disabled:!p,className:"absolute right-3 top-1/2 -translate-y-1/2 rounded-full border border-neutral-700 bg-black/60 p-2 text-white transition disabled:opacity-40",children:e.jsx(D,{size:20})})]})}):null}function re({memes:r}){const[n,s]=l.useState(null),[u,a]=l.useState(!1),i=c=>{s(c),a(!0)},p=c=>{a(c),c||s(null)},f=()=>{n!==null&&s(Math.max(0,n-1))},b=()=>{n!==null&&s(Math.min(r.length-1,n+1))},m=n!==null?r[n]:null;return e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("div",{className:"grid w-full grid-cols-2 gap-3 sm:grid-cols-[repeat(auto-fill,minmax(198px,1fr))] sm:gap-4",children:r.map((c,g)=>e.jsx(te,{id:c.id,title:c.title,image_url:c.image_url,media_url:c.media_url,type:c.type,onOpen:()=>i(g)}))}),e.jsx(ne,{isOpen:u,onOpenChange:p,meme:m,onPrev:f,onNext:b,hasPrev:n!==null&&n>0,hasNext:n!==null&&n<r.length-1})]})}const M=l.createContext(null);function se({availableTags:r,selectedTags:n,children:s}){return e.jsx(M.Provider,{value:{availableTags:r,selectedTags:n},children:s})}function ae(){const r=l.useContext(M);return r||{availableTags:[],selectedTags:[]}}function oe(){const{availableTags:r,selectedTags:n}=ae(),[s,u]=l.useState(""),[a,i]=l.useState(n??[]),[p,f]=l.useState(!1),[b,m]=l.useState((n??[]).length>0),[c,g]=l.useState(0),v=l.useRef(null);l.useEffect(()=>{i(n??[]),(n??[]).length>0&&m(!0)},[n?.join("|")]);const d=l.useMemo(()=>{const t=s.trim().toLowerCase(),o=r.filter(x=>!a.includes(x));return t?o.filter(x=>x.toLowerCase().includes(t)).slice(0,8):o.slice(0,8)},[a,r,s]);l.useEffect(()=>{c>=d.length&&d.length>0&&g(0)},[c,d.length]);const j=t=>{const o=t.length>0?{tags:t}:{};C.get(route("dashboard"),o,{preserveScroll:!0,preserveState:!0,replace:!0})},w=t=>{const o=t.trim();if(!o||a.includes(o)){u("");return}const x=[...a,o];i(x),u(""),j(x)},k=t=>{const o=a.filter(x=>x!==t);i(o),j(o)},I=t=>{if(t.key==="Escape"){t.preventDefault(),a.length===0&&s.trim()===""&&m(!1);return}if(t.key==="Backspace"&&s.trim()===""){a.length>0&&(t.preventDefault(),k(a[a.length-1]));return}if(t.key==="Tab"&&d.length>0){t.preventDefault();const x=t.shiftKey?-1:1,E=(c+x+d.length)%d.length;g(E);return}if(t.key!=="Enter"||(t.preventDefault(),d.length===0))return;const o=d[c]??d[0];o&&w(o)},_=()=>{m(!0),requestAnimationFrame(()=>v.current?.focus())},T=()=>{f(!1),a.length===0&&s.trim()===""&&m(!1)},N=l.useMemo(()=>{const t=s;if(!t)return"";const o=d[c]??d[0];return!o||!o.toLowerCase().startsWith(t.toLowerCase())?"":o.slice(t.length)},[c,d,s]);return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:["flex items-center overflow-hidden rounded-xl transition-all duration-300",b?"w-[220px] px-2 py-1 sm:w-[320px] border border-foreground/10 bg-foreground/5":"w-9 px-0 py-0 border border-transparent bg-transparent"].join(" "),children:[e.jsx("button",{type:"button",onClick:_,className:"flex h-9 w-9 items-center justify-center text-muted-foreground transition hover:text-foreground",children:e.jsx(S,{size:16})}),e.jsxs("div",{className:`flex flex-1 flex-wrap items-center gap-2 transition-opacity duration-200 ${b?"opacity-100":"pointer-events-none opacity-0"}`,children:[a.map(t=>e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-400/40 bg-emerald-400/10 px-2 py-0.5 text-[11px] font-medium text-emerald-700",children:[t,e.jsx("button",{type:"button",className:"text-emerald-700/70 hover:text-emerald-800",onClick:()=>k(t),children:"×"})]},t)),e.jsxs("div",{className:"relative flex min-w-[120px] flex-1 items-center",children:[N&&e.jsxs("span",{className:"pointer-events-none absolute left-0 top-1/2 -translate-y-1/2 text-xs text-muted-foreground/60",children:[e.jsx("span",{className:"invisible",children:s}),N]}),e.jsx("input",{ref:v,value:s,onChange:t=>{u(t.target.value),g(0)},onKeyDown:I,onFocus:()=>f(!0),onBlur:T,placeholder:r.length?"Тег":"Нет тегов",className:"h-8 w-full bg-transparent text-xs text-foreground outline-none placeholder:text-muted-foreground",disabled:r.length===0})]})]})]}),b&&p&&d.length>0&&e.jsx("div",{className:"absolute right-0 top-full z-20 mt-2 w-[220px] sm:w-[320px]",onMouseDown:t=>t.preventDefault(),children:e.jsxs("div",{className:"rounded-2xl border border-border/70 bg-background p-2 shadow-lg",children:[e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-1",children:"Возможные теги"}),e.jsx("div",{className:"flex flex-wrap gap-2 px-2 pb-2",children:d.map((t,o)=>e.jsx("button",{type:"button",onClick:()=>w(t),onMouseEnter:()=>g(o),className:["rounded-full border px-3 py-1 text-xs font-medium text-foreground transition",o===c?"border-foreground/20 bg-foreground/15":"border-foreground/10 bg-foreground/5 hover:bg-foreground/10"].join(" "),children:t},t))})]})})]})}const le="Meme Space",ie=[{title:"Мемчики",href:"/"}],ce=[{Icon:S,isActive:!1,node:oe},{Icon:G,target_url:"/memes/new",isActive:!1}];function ve(){const{memes:r,availableTags:n,selectedTags:s}=P().props,[u,a]=l.useState(!0);return l.useEffect(()=>{const i=()=>a(navigator.onLine);return i(),window.addEventListener("online",i),window.addEventListener("offline",i),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",i)}},[]),e.jsx(se,{availableTags:n,selectedTags:s,children:e.jsxs($,{breadcrumbs:ie,actions:ce,children:[e.jsx(L,{title:le}),!u&&e.jsx(z,{}),e.jsx(re,{memes:r})]})})}export{ve as default};
